with first_orders as  (
    select customer_id,min(order_date) as first_dates from 
    delivery
    group by customer_id
)
select round(
    sum(
        case when d.order_date=d.customer_pref_delivery_date then 1 else 0 end)*100.0/count(d.customer_id),2) as immediate_percentage
        from delivery d
        join first_orders f
        on d.customer_id=f.customer_id and
        d.order_date=f.first_dates;
// Title: Immediate Food Delivery II
